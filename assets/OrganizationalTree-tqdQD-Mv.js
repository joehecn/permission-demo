import{t as Y,o as Z,a as ee}from"./utils-fru_JMu1.js";import{d as _e,f as $e,g,h as we,c as le,a as t,b as a,w as r,u as f,F as xe,n as ae,r as h,o as k,t as $,i as de,j as w,e as x,__tla as Pe}from"./index-Es2zl-fp.js";let te,Ke=Promise.all([(()=>{try{return Pe}catch{}})()]).then(async()=>{let P,K,S,N,V,O,R,z,I,J,T,E,U,j,F,M,q,A;P=a("div",{class:"global-notes"},[a("p",null,"\u8BF4\u660E:"),a("ul",null,[a("li",null,"-- \u516C\u53F8\u7BA1\u7406\u5458 --")])],-1),K=a("h1",null,"\u90E8\u95E8\u7BA1\u7406",-1),S={id:"organizational-tree-page"},N={id:"org-tree"},V={class:"el-tree-node__label"},O={class:"drawer-body"},R={class:"drawer-content"},z={id:"area-tree"},I={class:"el-tree-node__label"},J={class:"drawer-footer"},T={class:"drawer-body"},E={class:"drawer-content"},U={class:"custom-tree-node-container"},j={class:"drawer-footer"},F=a("h1",null,"\u521B\u5EFA\u90E8\u95E8\u7BA1\u7406\u5458\u8D26\u53F7",-1),M={id:"org-tree-wrap"},q={class:"el-tree-node__label"},A={key:0,style:{display:"inline-block","margin-left":"8px"}},te=_e({__name:"OrganizationalTree",setup(Se){const s=$e(new Map),B=e=>s.get(e)||[],D=(e,l)=>{s.set(e,l),localStorage.setItem(e,JSON.stringify(l))},n=g(),ne={label:"label",children:"children",class:e=>e.children?"node":"area"};let C=null;const ie=e=>n.value?n.value.getCheckedNodes(!0).map(l=>l.id).includes(e):!1,re=e=>{!e||!n.value.getCheckedNodes(!0).map(l=>l.id).includes(e.id)||(m.value=!0,C=e,ae(()=>{var d;const l=B(`org/${(d=b.value)==null?void 0:d.id}/area/${e.id}`);p.value.setCheckedKeys(l)}))},se=()=>{n.value.setCurrentKey(null)},oe=()=>{p.value.setCurrentKey(null)},ue=e=>{_.value.setCurrentKey(null),e()},_=g(),G={label:"label",children:"children",class:"area"};let b=g(null);const ce=e=>{e&&(y.value=!0,b.value=e,ae(()=>{const l=B(`org/${e.id}`);n.value.setCheckedKeys(l)}))},y=g(!1),H=()=>{var l;const e=n.value.getCheckedNodes(!0).map(d=>d.id);D(`org/${(l=b.value)==null?void 0:l.id}`,e)},be=()=>{H(),_.value.setCurrentKey(null),y.value=!1},p=g(),m=g(!1),pe=[{id:4095,label:"\u533A\u57DF\u8D44\u6E90",children:[{id:63,label:"\u8BBE\u5907",children:[{id:7,label:"\u95E8\u7981",isPenultimate:!0,children:[{id:1,label:"\u53EA\u8BFB"},{id:2,label:"\u53EF\u5199",disabled:!0},{id:4,label:"\u63A7\u5236"}]},{id:56,label:"\u706F",isPenultimate:!0,children:[{id:8,label:"\u53EA\u8BFB"},{id:16,label:"\u53EF\u5199",disabled:!0},{id:32,label:"\u63A7\u5236"}]}]},{id:192,label:"\u6587\u6863",isPenultimate:!0,children:[{id:64,label:"\u53EA\u8BFB"},{id:128,label:"\u53EF\u5199"}]},{id:3840,label:"\u4EEA\u8868\u76D8",disabled:!0,children:[{id:768,label:"\u4E2D\u63A7\u9762\u677F",disabled:!0,isPenultimate:!0,children:[{id:256,label:"\u53EA\u8BFB",disabled:!0},{id:512,label:"\u53EF\u5199",disabled:!0}]},{id:3072,label:"\u6570\u636E\u56FE\u8868",isPenultimate:!0,children:[{id:1024,label:"\u53EA\u8BFB"},{id:2048,label:"\u53EF\u5199"}]}]}]}],ge=()=>{var l;const e=p.value.getCheckedNodes(!0).map(d=>d.id);D(`org/${(l=b.value)==null?void 0:l.id}/area/${C.id}`,e),p.value.setCurrentKey(null),n.value.setCurrentKey(null),m.value=!1,H()},he=e=>{p.value.setCurrentKey(null),n.value.setCurrentKey(null),e()},me=e=>!!s.get(e),ve=e=>{const l=s.get(e);if(!l)return!1;for(const d of l){const o=`${e}/area/${d}`;if(!s.get(o))return!1}return!0},fe=()=>{const e=Y(Z),l=Y(ee);e.forEach(d=>{const o=localStorage.getItem(`org/${d}`);o&&(s.set(`org/${d}`,JSON.parse(o)),l.forEach(u=>{const v=localStorage.getItem(`org/${d}/area/${u}`);v&&s.set(`org/${d}/area/${u}`,JSON.parse(v))}))})},ye=e=>e.isPenultimate?"is-penultimate":null,ke=[{id:1,label:"\u516C\u53F8",isPenultimate:!0,children:[{id:2,label:"\u4EA7\u54C1\u90E8",isPenultimate:!0,children:[{id:3,label:"p-admin@club.com"}]},{id:4,label:"\u5F00\u53D1\u90E8",isPenultimate:!0,children:[{id:5,label:"d-admin@club.com"},{id:6,label:"\u524D\u7AEF\u7EC4",isPenultimate:!0,children:[{id:7,label:"df-admin@club.com"}]},{id:6,label:"\u540E\u7AEF\u7EC4",isPenultimate:!0,children:[{id:7,label:"db-admin@club.com"}]}]}]}];return we(()=>{fe()}),(e,l)=>{var Q;const d=h("el-divider"),o=h("el-badge"),u=h("el-tree"),v=h("el-button"),L=h("el-drawer"),Ce=h("el-tag");return k(),le(xe,null,[P,t(d),K,a("div",S,[a("div",N,[t(u,{ref_key:"orgTreeRef",ref:_,"check-on-click-node":"","default-expand-all":"","node-key":"id",data:f(Z),props:G,"expand-on-click-node":!1,onCurrentChange:ce},{default:r(({node:i,data:c})=>[a("span",V,[a("span",null,$(i.label),1),t(o,{style:{"margin-right":"3px"},"is-dot":"",type:ve(`org/${c.id}`)?"success":"warning"},null,8,["type"])])]),_:1},8,["data"])]),t(L,{modelValue:y.value,"onUpdate:modelValue":l[1]||(l[1]=i=>y.value=i),size:600,title:((Q=f(b))==null?void 0:Q.label)+" - \u9009\u62E9\u533A\u57DF","show-close":!1,"before-close":ue},{default:r(()=>{var i;return[a("div",O,[a("div",R,[a("div",z,[t(u,{ref_key:"areaTreeRef",ref:n,"default-expand-all":"","node-key":"id","show-checkbox":"",data:f(ee),props:ne,"expand-on-click-node":!1,onCurrentChange:re,onCheckChange:se},{default:r(({node:c,data:W})=>{var X;return[a("span",I,[a("span",null,$(c.label),1),ie(W.id)?(k(),de(o,{key:0,style:{"margin-right":"3px"},"is-dot":"",type:me(`org/${(X=f(b))==null?void 0:X.id}/area/${W.id}`)?"success":"warning"},null,8,["type"])):w("",!0)])]}),_:1},8,["data"])])]),a("div",J,[t(v,{type:"primary",onClick:be},{default:r(()=>[x("Save")]),_:1})]),t(L,{modelValue:m.value,"onUpdate:modelValue":l[0]||(l[0]=c=>m.value=c),title:((i=f(C))==null?void 0:i.label)+" - \u9009\u62E9\u533A\u57DF\u8D44\u6E90","append-to-body":!0,"show-close":!1,"before-close":he},{default:r(()=>[a("div",T,[a("div",E,[a("div",U,[m.value?(k(),de(u,{key:0,ref_key:"areaResourceRef",ref:p,"node-key":"id","show-checkbox":"","default-expand-all":"",data:pe,"expand-on-click-node":!1,props:G,onCheckChange:oe},null,512)):w("",!0)])]),a("div",j,[t(v,{type:"primary",onClick:ge},{default:r(()=>[x("Save")]),_:1})])])]),_:1},8,["modelValue","title"])])]}),_:1},8,["modelValue","title"])]),t(d),F,a("div",M,[t(u,{"default-expand-all":"","node-key":"id",data:ke,props:{class:ye},"expand-on-click-node":!1},{default:r(({node:i,data:c})=>[a("span",q,[a("span",null,$(i.label),1),c.isPenultimate?w("",!0):(k(),le("span",A,[t(Ce,{type:"info"},{default:r(()=>[x("\u90E8\u95E8\u7BA1\u7406\u5458 (\u529F\u80FD\u89D2\u8272)")]),_:1})]))])]),_:1},8,["props"])])],64)}}})});export{Ke as __tla,te as default};
