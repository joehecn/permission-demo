import{t as $,a as x,f as Se,b as te,c as de,o as xe}from"./utils-fru_JMu1.js";import{d as Ke,f as Ne,g as r,h as Re,c as K,a as i,b as t,w as c,u as N,F as Ve,n as se,r as f,o as m,t as R,e as V,i as ne,j as re,__tla as Ie}from"./index-Es2zl-fp.js";let ie,Je=Promise.all([(()=>{try{return Ie}catch{}})()]).then(async()=>{let I,J,O,E,T,U,z,D,F,M,j,q,A,B,G;I=t("div",{class:"global-notes"},[t("p",null,"\u8BF4\u660E:"),t("ul",null,[t("li",null,"-- \u90E8\u95E8\u7BA1\u7406\u5458 --")])],-1),J=t("h1",null,"\u6570\u636E\u89D2\u8272",-1),O={id:"org-tree-wrap"},E={class:"el-tree-node__label"},T={key:0},U={key:1},z={class:"drawer-body"},D={class:"drawer-content"},F={id:"area-tree"},M={class:"el-tree-node__label"},j={class:"drawer-footer"},q={class:"drawer-body"},A={class:"drawer-content"},B={class:"custom-tree-node-container"},G={class:"drawer-footer"},ie=Ke({__name:"DataRole",setup(Oe){const s=Ne(new Map),C=$(x),H=r(x),y=e=>s.get(e)||[],L=(e,l)=>{s.set(e,l),localStorage.setItem(e,JSON.stringify(l))},oe=e=>!!s.get(e),ue=e=>{const l=s.get(e);if(!l)return!1;for(const a of l){const d=`${e}/area/${a}`;if(!s.get(d))return!1}return!0},ce=e=>e.isPenultimate?"is-penultimate":null,be=e=>e.children?"node":"area",_=r(),w=[{id:1,label:"\u516C\u53F8",isPenultimate:!0,children:[{id:3,label:"\u4EA7\u54C1\u90E8",isPenultimate:!0,children:[{id:7,label:"\u6570\u636E\u89D2\u82721"}]},{id:4,label:"\u5F00\u53D1\u90E8",isPenultimate:!0,children:[{id:8,label:"\u6570\u636E\u89D2\u82722"},{id:5,label:"\u524D\u7AEF\u7EC4",isPenultimate:!0,children:[{id:9,label:"\u6570\u636E\u89D2\u82723"}]},{id:6,label:"\u540E\u7AEF\u7EC4",isPenultimate:!0,children:[{id:10,label:"\u6570\u636E\u89D2\u82724"}]}]}]}];let b=r(null),Q=r(null);const pe=e=>{if(!e||e.children)return;const l=Se(w,e.id);Q.value=l;const a=y(`org/${l.id}`),d=te(a,C);H.value=de(x,d),k.value=!0,b.value=e,se(()=>{const o=y(`data/${e.id}`);n.value.setCheckedKeys(o)})},k=r(!1),W=()=>{var l;const e=n.value.getCheckedNodes(!0).map(a=>a.id);L(`data/${(l=b.value)==null?void 0:l.id}`,e)},he=()=>{W(),_.value.setCurrentKey(null),k.value=!1},ve={label:"label",children:"children",class:"area"},fe={label:"label",children:"children",class:be},n=r(),ge=e=>{_.value.setCurrentKey(null),e()};let P=null;const me=e=>n.value?n.value.getCheckedNodes(!0).map(l=>l.id).includes(e):!1,ye=e=>{var d;if(!e||!n.value.getCheckedNodes(!0).map(o=>o.id).includes(e.id))return;const l=y(`org/${(d=Q.value)==null?void 0:d.id}/area/${e.id}`),a=te(l,Ce);X.value=de(S,a),g.value=!0,P=e,se(()=>{var h;const o=y(`data/${(h=b.value)==null?void 0:h.id}/area/${e.id}`);p.value.setCheckedKeys(o)})},ke=()=>{n.value.setCurrentKey(null)},$e=()=>{p.value.setCurrentKey(null)},p=r(),g=r(!1),S=[{id:4095,label:"\u533A\u57DF\u8D44\u6E90",children:[{id:63,label:"\u8BBE\u5907",children:[{id:7,label:"\u95E8\u7981",isPenultimate:!0,children:[{id:1,label:"\u53EA\u8BFB"},{id:2,label:"\u53EF\u5199",disabled:!0},{id:4,label:"\u63A7\u5236"}]},{id:56,label:"\u706F",isPenultimate:!0,children:[{id:8,label:"\u53EA\u8BFB"},{id:16,label:"\u53EF\u5199",disabled:!0},{id:32,label:"\u63A7\u5236"}]}]},{id:192,label:"\u6587\u6863",isPenultimate:!0,children:[{id:64,label:"\u53EA\u8BFB"},{id:128,label:"\u53EF\u5199"}]},{id:3840,label:"\u4EEA\u8868\u76D8",disabled:!0,children:[{id:768,label:"\u4E2D\u63A7\u9762\u677F",disabled:!0,isPenultimate:!0,children:[{id:256,label:"\u53EA\u8BFB",disabled:!0},{id:512,label:"\u53EF\u5199",disabled:!0}]},{id:3072,label:"\u6570\u636E\u56FE\u8868",isPenultimate:!0,children:[{id:1024,label:"\u53EA\u8BFB"},{id:2048,label:"\u53EF\u5199"}]}]}]}],Ce=$(S),X=r(S),_e=()=>{var l;const e=p.value.getCheckedNodes(!0).map(a=>a.id);L(`data/${(l=b.value)==null?void 0:l.id}/area/${P.id}`,e),p.value.setCurrentKey(null),n.value.setCurrentKey(null),g.value=!1,W()},we=e=>{p.value.setCurrentKey(null),n.value.setCurrentKey(null),e()},Pe=()=>{$(xe).forEach(e=>{const l=localStorage.getItem(`org/${e}`);l&&(s.set(`org/${e}`,JSON.parse(l)),C.forEach(a=>{const d=localStorage.getItem(`org/${e}/area/${a}`);d&&s.set(`org/${e}/area/${a}`,JSON.parse(d))}))}),$(w).forEach(e=>{const l=localStorage.getItem(`data/${e}`);l&&(s.set(`data/${e}`,JSON.parse(l)),C.forEach(a=>{const d=localStorage.getItem(`data/${e}/area/${a}`);d&&s.set(`data/${e}/area/${a}`,JSON.parse(d))}))})};return Re(()=>{Pe()}),(e,l)=>{var ee;const a=f("el-divider"),d=f("el-badge"),o=f("el-tag"),h=f("el-tree"),Y=f("el-button"),Z=f("el-drawer");return m(),K(Ve,null,[I,i(a),J,t("div",O,[i(h,{ref_key:"dataTreeRef",ref:_,"check-on-click-node":"","default-expand-all":"","node-key":"id",data:w,props:{class:ce},"expand-on-click-node":!1,onCurrentChange:pe},{default:c(({node:u,data:v})=>[t("span",E,[v.isPenultimate?(m(),K("span",T,R(u.label),1)):(m(),K("span",U,[i(o,null,{default:c(()=>[V(R(u.label)+" ",1),i(d,{style:{"margin-right":"3px"},"is-dot":"",type:ue(`data/${v.id}`)?"success":"warning"},null,8,["type"])]),_:2},1024)]))])]),_:1},8,["props"]),i(Z,{modelValue:k.value,"onUpdate:modelValue":l[1]||(l[1]=u=>k.value=u),size:600,title:((ee=N(b))==null?void 0:ee.label)+" - \u9009\u62E9\u533A\u57DF","show-close":!1,"before-close":ge},{default:c(()=>{var u;return[t("div",z,[t("div",D,[t("div",F,[i(h,{ref_key:"areaTreeRef",ref:n,"default-expand-all":"","node-key":"id","show-checkbox":"",data:H.value,props:fe,"expand-on-click-node":!1,onCurrentChange:ye,onCheckChange:ke},{default:c(({node:v,data:le})=>{var ae;return[t("span",M,[t("span",null,R(v.label),1),me(le.id)?(m(),ne(d,{key:0,style:{"margin-right":"3px"},"is-dot":"",type:oe(`data/${(ae=N(b))==null?void 0:ae.id}/area/${le.id}`)?"success":"warning"},null,8,["type"])):re("",!0)])]}),_:1},8,["data"])])]),t("div",j,[i(Y,{type:"primary",onClick:he},{default:c(()=>[V("Save")]),_:1})]),i(Z,{modelValue:g.value,"onUpdate:modelValue":l[0]||(l[0]=v=>g.value=v),title:((u=N(P))==null?void 0:u.label)+" - \u9009\u62E9\u533A\u57DF\u8D44\u6E90","append-to-body":!0,"show-close":!1,"before-close":we},{default:c(()=>[t("div",q,[t("div",A,[t("div",B,[g.value?(m(),ne(h,{key:0,ref_key:"areaResourceRef",ref:p,"node-key":"id","show-checkbox":"","default-expand-all":"",data:X.value,"expand-on-click-node":!1,props:ve,onCheckChange:$e},null,8,["data"])):re("",!0)])]),t("div",G,[i(Y,{type:"primary",onClick:_e},{default:c(()=>[V("Save")]),_:1})])])]),_:1},8,["modelValue","title"])])]}),_:1},8,["modelValue","title"])])],64)}}})});export{Je as __tla,ie as default};
